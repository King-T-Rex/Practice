/*
Автор: Кузнецов Александр

Назначение: программа берёт матрицу A и умножает её на транспонированную A^T.
В результате получается новая матрица C.

Условия:
    - матрица A вводится пользователем
*/

#define _CRT_SECURE_NO_WARNINGS // Эта строчка нужна, чтобы не ругался компилятор на scanf и printf

#include <stdio.h>     // Оно подключает стандартную библиотеку ввода/вывода (printf, scanf)
#include <locale.h>    // Оно подключает библиотеку для поддержки русской локали (чтобы выводились русские буквы в консоли)
#include <windows.h>


int main() {

    // Устанавливает локаль — это нужно для корректного отображения кириллицы в консоли
    setlocale(LC_ALL, ".UTF-8");
    SetConsoleCP(CP_UTF8);              // задать кодировку для ввода
    SetConsoleOutputCP(CP_UTF8);        // задать кодировку для ввода

    const int max = 100; // Максимальный размер матрицы (100 строк и 100 столбцов)
    double A[max][max];  // Исходная матрица A (размер m×n)
    double C[max][max];  // Результирующая матрица C (размер m×m)

    int m, n;            // m — количество строк в матрице A, n — количество столбцов в матрице A

    // Проcит пользователя ввести размеры матрицы A
    printf("Введите количество строк матрицы A (m <= %d): ", max);
    scanf("%d", &m);

    /*
       scanf("%d", &m);

       Здесь:
       - "%d" означает, что оно ожидает ввод целого числа (тип int).
       - &m означает "взять адрес переменной m".
         
         Функция scanf должна знать, куда записать введённое число.
         Поэтому оно передаёт не саму переменную, а её адрес.
         Тогда scanf положит введённое число внутрь переменной m.
    */

    printf("Введите количество столбцов матрицы A (n <= %d): ", max);
    scanf("%d", &n);

    /*
       Аналогично:
       - "%d" — ждёт целое число.
       - &n — адрес переменной n, в которую будет записан ввод пользователя.
    */

    // Проверка корректности ввода введенных размеров
    if (m <= 0 || n <= 0 || m > max || n > max) {
        printf("Ошибка: неверные размеры матрицы.\n"); // Сообщение об ошибке
        return 1;                                      // Завершение программу с кодом ошибки
    }

    // Ввод элементов матрицы A от пользователя
    printf("Введите элементы матрицы A (%d строк, %d столбцов):\n", m, n);
    for (int i = 0; i < m; ++i) {      // цикл по строкам
        for (int j = 0; j < n; ++j) {  // цикл по столбцам
            
            scanf("%lf", &A[i][j]);

            /*
               scanf("%lf", &A[i][j]);

               - "%lf" означает, что оно ждёт число с плавающей точкой (тип double).
               - &A[i][j] — это адрес ячейки в матрице, куда будет записано введённое пользователем число.
            */
        }
    }

    /*
       Теперь нужно вычислить произведение матрицы A (размер m×n) на её транспонированную A^T (размер n×m).
       В результате получится матрица C размером m×m.

       Формула:
           C[i][j] = Σ (A[i][k] * A[j][k]), где k = 0..n-1

       То есть мы берём i-ю строку матрицы A и j-ю строку матрицы A,
       перемножаем их элементы по порядку и складываем.
       Это называется "скалярное произведение строк".

       Или с другими словами, C[i][j] — это скалярное произведение i-й и j-й строк матрицы A.
    */

    for (int i = 0; i < m; ++i) {               // Идет по строкам результата C
        for (int j = 0; j < m; ++j) {           // Идет по столбцам результата C
            C[i][j] = 0;                        // Обнуляет текущую ячейку перед суммированием
            for (int k = 0; k < n; ++k) {       // Суммирует произведения элементов
                C[i][j] += A[i][k] * A[j][k];   // Добавляет произведение элементов A[i][k] и A[j][k]
            }
        }
    }

    // Вывод результата на экран
    printf("\nРезультат умножения A * A^T (матрица размера %d x %d):\n", m, m);
    for (int i = 0; i < m; ++i) {           // цикл по строкам результата
        for (int j = 0; j < m; ++j) {       // цикл по столбцам результата
            printf("%8.2f", C[i][j]);       // Оно печатает элемент C[i][j] с двумя знаками после запятой

            /*
               - %f — выводим число с плавающей точкой (double)
               - .2 — два знака после запятой
               - 8 — ширина поля вывода, число займёт минимум 8 символов, выравниваясь вправо

            */
        }
        printf("\n"); // Переход на новую строку после печати всей строки матрицы
    }

    return 0;
}