/*
Автор: Кузнецов Александр
Программа обрабатывает последовательность действительных чисел:
	- Заменяет все элементы, меньшие двух, на ноль
	- Считает сумму и количество элементов из диапазона [3, 7]
*/

#include <stdio.h>  // Для работы с вводом/выводом
#include <stdlib.h> // Для генерации случайных чисел
#include <locale.h> // Для поддержки русского языка
#include <time.h>   // Для получения текущего времени
#include <windows.h>     // Подключает для SetConsoleCP — настройка кодировки консоли Windows

/*
Точка входа в программу
Основная функция:
    - Устанавливает локаль для корректного отображения русского языка
    - Инициализирует генератор случайных чисел
    - Запрашивает у пользователя размер массива
    - Проверяет корректность ввода
    - Заполняет массив случайными числами
    - Выводит исходную последовательность
    - Изменяет массив по заданному правилу
    - Выводит модифицированную последовательность
    - Подсчитывает сумму и количество элементов из диапазона [3, 7]
    - Выводит результаты
*/


int main() {
    // Настройка локали и кодировки консоли для корректного отображения русского текста
    setlocale(LC_ALL, ".UTF-8");
    SetConsoleCP(CP_UTF8);           // Кодировка ввода
    SetConsoleOutputCP(CP_UTF8);     // Кодировка вывода

    // Инициализация генератора случайных чисел текущим временем в секундах
    srand(time(NULL));              

    // Максимальный размер массива
    const unsigned N = 1024; 

    // Статический массив, размер известен на этапе компиляции; память освобождается автоматически.
    double array[N];                

    // Реальное количество элементов
    unsigned n;                     

    // Вывод пояснительной информации пользователю
    printf("Даны натуральное число n (n < %d), действительные числа x1,...,xn.\n", N);
    printf("Все элементы меньше 2 будут заменены на 0.\n");
    printf("Будет найдена сумма и количество элементов из отрезка [3,7].\n");
    printf("Задайте количество элементов массива (n < %d): ", N);
    // Операция взятия адреса n
    scanf("%u", &n);

    // Проверка: n должно быть натуральным числом и не превышать максимальный размер массива
    if (n == 0 || n > N) {
        printf("Ошибка: значение n должно быть натуральным и не превышать %d\n", N);
        return 1;
    }

    // Заполнение массива случайными числами от -20 до 30
    for (unsigned i = 0; i < n; ++i) {
        array[i] = 1.0 * rand() / RAND_MAX * 50 - 20; // Вещественное число в диапазоне [-20; 30]
    }


    // Вывод заголовка для исходной последовательности
    printf("\nИсходная последовательность:\n");
    // Вывод элементов массива по 10 штук в строке
    for (unsigned i = 0; i < n; ++i) {
        printf("%6.2f  ", array[i]);
        if ((i + 1) % 10 == 0) printf("\n"); // Переход на новую строку каждые 10 чисел
    }
    printf("\n");

    // Замена всех элементов, меньших двух, на ноль
    for (unsigned i = 0; i < n; ++i) {
        if (array[i] < 2) {
            array[i] = 0;
        }
    }

    // Вывод заголовка для модифицированной последовательности
    printf("\nМодифицированная последовательность:\n");
    // Вывод изменённого массива аналогично исходному
    for (unsigned i = 0; i < n; ++i) {
        printf("%6.2f  ", array[i]);
        if ((i + 1) % 10 == 0) printf("\n");
    }
    printf("\n");

    /*
    Подсчёт суммы и количества элементов из отрезка [3, 7]
    Проход по массиву с проверкой условия:
        если array[i] ? [3, 7], то:
            sum += array[i];
            ++count;
    */

    double sum = 0;
    int count = 0;

    for (unsigned i = 0; i < n; ++i) {
        if (array[i] >= 3 && array[i] <= 7) {
            sum += array[i]; // Добавление к общей сумме
            ++count;         // Увеличение счётчика
        }
    }

    // Вывод результатов пользователю
    printf("Сумма элементов из отрезка [3,7]: %8.2f\n", sum);
    printf("Количество таких элементов:         %4d\n", count);

    // Завершение программы
    return 0;

}